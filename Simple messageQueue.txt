//From Windows Service, use this code
MessageQueue messageQueue = null;
if (MessageQueue.Exists(@".\Private$\SomeTestName"))
{
    messageQueue = new MessageQueue(@".\Private$\SomeTestName");
    messageQueue.Label = "Testing Queue";
}
else
{
    // Create the Queue
    MessageQueue.Create(@".\Private$\SomeTestName");
    messageQueue = new MessageQueue(@".\Private$\SomeTestName");
    messageQueue.Label = "Newly Created Queue";
}
messageQueue.Send("First ever Message is sent to MSMQ", "Title");

/////////////////////////////////////////////////////////

//From Windows application
MessageQueue messageQueue = new MessageQueue(@".\Private$\SomeTestName");
System.Messaging.Message[] messages = messageQueue.GetAllMessages();

foreach (System.Messaging.Message message in messages)
{
    //Do something with the message.
}
// after all processing, delete all the messages
messageQueue.Purge();


référence: http://stackoverflow.com/questions/11076790/the-bare-minimum-needed-to-write-a-msmq-sample-application

Pour avoir accès à la classe messageQueue il faut ajouter la référence à System.Messaging

Pour activer le MSMQ voir : http://www.outsystems.com/forums/discussion/6831/microsoft-message-queue-installation-for-community-edition/